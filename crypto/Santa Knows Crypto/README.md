# Santa Knows Crypto

> Author: howard41436 | 楊皓丞 | B06902097, devin6011 | 林首志 | B06902049

### Description

Lately, Santa started learning cryptography in his spare time in order to increse the security in his toy factory. Now he wants you to test out a prototype. If you can bypass his challange he will reward you acordingly.

source: [src](./src)

### Vulnerability

LFSR

### Solution

The server used a strong ElGamal, but a weak PRNG. It uses LFSR as PRNG, and when we decrypted the message incorrectly, it tells us the correct answer `m` and the power `y`  used in that turn. `y` is generated by the LFSR PRNG, `y` has 1024 bits, and the length of the LFSR is 256. We know that we only need `2n` output bits of the LFSR to calculate the entire internal state of the LFSR, and `y` gives us more than required. I found a `Berlekamp_Massey_algorithm` online that can be used to solve LFSRs using output bits. After knowing the polynomial, we can predict all future output bits, that is, all `y` of future rounds. Now the only problem left is that we have to know `x` to compute `h`. But `x` consists of the 1024 output bits of the LFSR preceding `y`, and using similar methods of predicting future ouput bits, we can calculate ouput bits in the past too. Therefore, we can calculate `x`, then `h`, then with future `y`'s, we can compute `s` to decrypt the cipher text `c` each round. The codes I used are in [code](./code).